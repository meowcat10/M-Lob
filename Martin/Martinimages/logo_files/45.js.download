"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[45],{3968:function(e,t,n){n.d(t,{a:function(){return s},b:function(){return d}});var a=n(6274),i=n(1837),r=n(8554),o=n("odsp.util_118").HW.isActivated("686714b6-ee9c-44e7-9cc2-1fbe75a88eac"),s={ID:"",displayName:r.b,realFieldName:"File size",internalName:"FileSizeDisplay",type:i.a.FileSize,width:150,isCalculated:!0,isReadOnly:!0,isSortable:!0,isEditable:!1,rawFieldData:{FieldType:"FileSize",Name:"FileSizeDisplay",Groupable:"FALSE"}},c={ID:"",displayName:r.a,realFieldName:"Activity",internalName:"FileActivity",type:i.a.FileActivity,width:445,isCalculated:!0,isSortable:!1,isReadOnly:!0,isEditable:!1};function d(e,t){var n=[],i=null;if((0,a.a)(t)){for(var r=0,d=e;r<d.length;r++){var l=d[r];"SharedWith"===l.internalName?i=l:n.push(l)}return o&&n.push(s),i&&n.push(i),n.push(c),n}return e}}
,4962:function(e,t,n){n.d(t,{a:function(){return i}});var a=n("odsp.util_118").HW.isActivated("43c21516-7a9e-4d81-ba4e-373de20859b8");function i(e){var t,n,i={};if((null===(t=null==e?void 0:e.schema)||void 0===t?void 0:t.aggregate)&&((null===(n=null==e?void 0:e.items)||void 0===n?void 0:n.length)>0||!a))for(var o=e.schema.aggregate,s=0,c=Object.keys(o);s<c.length;s++){var d=c[s],l=r(e,d);l&&(i[d]=l)}return Object.keys(i).length>0?i:void 0}function r(e,t){var n,i,r,o,s,c,d;d=a?null===(s=null==e?void 0:e.items)||void 0===s?void 0:s[0]:(null===(n=null==e?void 0:e.items)||void 0===n?void 0:n[0])||(null===(o=null===(r=null===(i=e.rawResponse)||void 0===i?void 0:i.ListData)||void 0===r?void 0:r.Row)||void 0===o?void 0:o[0]);var l=null===(c=null==e?void 0:e.schema)||void 0===c?void 0:c.aggregate;if(d&&l&&t&&l[t]){var u=l[t];return{type:u,value:d[t+"."+u]}}}}
,2521:function(e,t,n){n.d(t,{a:function(){return h},b:function(){return I},c:function(){return S},d:function(){return g},e:function(){return y},f:function(){return v},g:function(){return b}});var a=n("tslib_826"),i=n("odsp.util_118"),r=n(156),o=n(4962);function s(e){if(e&&e.rawResponse){var t=e.rawResponse;return t.AvailableContentTypes||t.ListContenTypes}}var c=n(2830),d=n(399),l=n(6275),u=n(3968),f=n(6274),p=i.HW.isActivated("89dbb277-1823-422d-b50f-1b8f23516afd","05/17/2023","Keep old group collased state on same view"),m=i.HW.isActivated("686714b6-ee9c-44e7-9cc2-1fbe75a88eac"),_=i.HW.isActivated("B84CDD00-78FD-4CA4-97E0-B8CFF559E79F"),h=new i.hK({name:"ListDataStateStore.key",factory:{dependencies:{spartanViewInstance:d.a},create:function(){var e,t="init";return{instance:e=new r.a({listStyle:v(t,void 0),listRenderData:g(t,void 0),listSettings:y(t,void 0),commandBarCustomizationInput:S(t,void 0),pinnedItemData:b(t,void 0),projectedListRenderData:g(t,void 0)}),disposable:e}}}});function b(e,t,n,a,i,r){return r?{publisher:e,pinnedItemIds:r}:{publisher:e,pinnedItemIds:(null==t?void 0:t.pinnedItemIds)||(null==n?void 0:n.state.pinnedItemData.pinnedItemIds)}}function g(e,t,n,i,r){var d,h,b,g,v,y,S,D,I=2;t&&t.schema.fields.length>0&&"DocIcon"===t.schema.fields[0].internalName&&I++,t&&t.schema.viewFormatter&&(I-=t.schema.viewFormatter.hideSelection?1:0);var x=s(t)||(null==n?void 0:n.state.listRenderData.availableContentTypes),C=function(e){if(e&&e.rawResponse)return e.rawResponse.FolderContentTypeOrder||s(e)}(t)||(null==n?void 0:n.state.listRenderData.folderContentTypeOrder),O=r||(null===(d=null==n?void 0:n.state)||void 0===d?void 0:d.listRenderData.requestItemKey),w=O&&(0,l.a)(O),E=w?(0,c.c)(w,t,{areGroupsCollapsed:null==t?void 0:t.schema.areAllGroupsCollapsed}):void 0;if(!p){var A=null===(b=null===(h=null==n?void 0:n.state)||void 0===h?void 0:h.listRenderData.itemSet)||void 0===b?void 0:b.collapsedGroupKeysSet,L=null===(y=null===(v=null===(g=null==n?void 0:n.state)||void 0===g?void 0:g.listRenderData.schema)||void 0===v?void 0:v.currentView)||void 0===y?void 0:y.Id;A&&A.size>0&&L===(null===(S=null==t?void 0:t.schema.currentView)||void 0===S?void 0:S.Id)&&E&&(E=(0,a.W_)((0,a.W_)({},E),{collapsedGroupKeysSet:A}))}var k=(null==t?void 0:t.pageContext)||i||(null===(D=null==n?void 0:n.state)||void 0===D?void 0:D.listRenderData.pageContext),M=t&&t.list&&(0,f.a)(t.list),P=null==t?void 0:t.schema;!m&&M&&P&&P.fields&&(P=(0,a.W_)((0,a.W_)({},P),{fields:(0,a.AE)((0,a.AE)([],P.fields,!0),[u.a],!1)}));var T,U=(null==t?void 0:t.pinnedItemIds)||(null==n?void 0:n.state.listRenderData.pinnedItemIds),F=null==n?void 0:n.state.projectedListRenderData;T=_?{publisher:e,numStickyColumns:I,requestItemKey:O,itemSet:E,pageContext:k,list:null==t?void 0:t.list,schema:P,seedItems:null==t?void 0:t.items,seedItemsNextPageToken:null==t?void 0:t.nextPage,seedGroups:null==t?void 0:t.groups,viewData:null==t?void 0:t.viewData,views:null==t?void 0:t.views,rawResponse:null==t?void 0:t.rawResponse,availableContentTypes:x,folderContentTypeOrder:C,pinnedItemIds:U}:{publisher:e,numStickyColumns:I,requestItemKey:O,itemSet:E,pageContext:k,list:null==t?void 0:t.list,schema:P,seedItems:(0,a.AE)((0,a.AE)([],(null==F?void 0:F.seedItems)?F.seedItems:[],!0),(null==t?void 0:t.items)?t.items:[],!0),seedItemsNextPageToken:null==t?void 0:t.nextPage,seedGroups:null==t?void 0:t.groups,viewData:null==t?void 0:t.viewData,views:null==t?void 0:t.views,rawResponse:null==t?void 0:t.rawResponse,availableContentTypes:x,folderContentTypeOrder:C,pinnedItemIds:U};var H=(0,o.a)(t);return H&&(T.aggregateData=H),T}function v(e,t){return{publisher:e,icon:null==t?void 0:t.icon,color:null==t?void 0:t.color}}function y(e,t,n){var a,i,r;if(t&&t.rawResponse){var o=(null===(a=null==t?void 0:t.rawResponse)||void 0===a?void 0:a.CustomActions)||(null===(r=null===(i=null==n?void 0:n.state)||void 0===i?void 0:i.listSettings)||void 0===r?void 0:r.customActions)||[];return{publisher:e,allowCreateFolder:t.rawResponse.AllowCreateFolder,contentTypeEnabled:t.rawResponse.ContentTypesEnabled,folderContentTypeOrder:t.rawResponse.FolderContentTypeOrder,customActions:o}}return{publisher:e}}function S(e,t){var n=null==t?void 0:t.schema;return{publisher:e,customFormatterSchema:null==n?void 0:n.customFormatterSchema,viewFormatter:null==n?void 0:n.viewFormatter}}var D={listStyle:v,listRenderData:g,listSettings:y,commandBarCustomizationInput:S,pinnedItemData:b,projectedListRenderData:g},I=new i.hK({name:"ListDataStateStore.key_updater",factory:{dependencies:{listDataStateStore:h},create:function(e){var t=e.listDataStateStore;return{instance:function(e,n,a,i,r,o){var s="All"===n?Object.keys(t.state):n,c=s.indexOf("projectedListRenderData");-1!==c&&s.splice(c,1);for(var d=0,l=s;d<l.length;d++){var u=l[d];t.update(u,D[u](e,a,t,r,o),i)}}}}}})}
,2811:function(e,t,n){n.d(t,{a:function(){return i},b:function(){return o},c:function(){return c},d:function(){return d},e:function(){return r},f:function(){return s}});var a="__placeholderGroup__",i={key:a,name:"Placeholder",itemCount:1,displayCount:1};function r(e){return e.key===a}function o(e){return{ID:e,Editor:[],__placeholder:!0}}function s(e){return!!e.__placeholder}function c(e){return e.ID}function d(e,t){return e[t]&&!s(e[t])}}
,6274:function(e,t,n){n.d(t,{a:function(){return i}});var a=n(67);function i(e){return(null==e?void 0:e.templateType)===a.a.mySiteDocumentLibrary}}
,6275:function(e,t,n){n.d(t,{a:function(){return c}});var a=n("tslib_826"),i=n(1555),r=n(834),o=n(265),s=n(338);function c(e){if(s.a.matches(e)){var t=s.a.deserialize(e);return void 0!==t.rootFolder?o.a.serialize((0,a.W_)((0,a.W_)({},t),{rootFolder:t.rootFolder})):void 0}return r.a.matches(e)?c(r.a.deserialize(e).remoteItemKey):i.a.matches(e)?c(i.a.deserialize(e).currentItemKey):o.a.matches(e)?e:void 0}}
,2830:function(e,t,n){n.d(t,{a:function(){return b},b:function(){return h},c:function(){return g}});var a=n("tslib_826"),i=n(2811),r=n(1733),o=n(265),s=n(1568),c=n(8553),d=n(3926),l=n("odsp.util_118"),u=l.HW.isActivated("371E76C1-A0F2-4CEE-85FC-D06FFC309760"),f=l.HW.isActivated("459ca055-2d3c-4671-a461-a8213619e808"),p=l.HW.isActivated("27a0e276-7f79-43db-bdce-b39667c510e3"),m=l.HW.isActivated("66865304-ea50-4a91-8208-f6de5740be66"),_=l.HW.isActivated("4BB4C4A0-4BC8-4661-A2E4-A1EC782B68BF");function h(e){return void 0!==e.groupings}function b(e){return"group".concat(e)}function g(e,t,n){var s,c,h,b,g,y;void 0===n&&(n={});var S=n.prevItemSet;if(!m&&S&&S.key!==e)throw new l.EI({code:"MakeItemSetKeyDoesNotMatchPrevItemSetKey"});var D=o.a.deserialize(e);if(!t)return(0,a.W_)((0,a.W_)({key:e},D),{items:[],isResolved:!1});var I=n.pageKey,x=n.areGroupsCollapsed,C=t.items,O=t.groups,w=t.rawResponse,E=null===(c=t.currentView)||void 0===c?void 0:c.RowLimit,A=!!((null===(h=null==w?void 0:w.ListSchema)||void 0===h?void 0:h.ItemCount)&&(null===(b=w.ListSchema)||void 0===b?void 0:b.ItemCount)>5e3),L=I&&(null==S?void 0:S.items.findIndex(function(e){return(0,i.f)(e)&&(0,i.c)(e)===I}));if(I&&-1===L)return S||(0,a.W_)((0,a.W_)({key:e},D),{items:[],isResolved:!1});var k,M=void 0!==S?S.areAllGroupsCollapsed:x,P=function(e,t,n){var i,r,s;if(!f&&n)return o.a.deserialize(o.a.serialize(n));var c=null==e?void 0:e.rawResponse,l=(null==c?void 0:c.ListData)||{},p=l.SortField,m=l.SortDir,h=l.FilterLink,b=p||t.sortFieldKey,g="ascending"===m||"descending"!==m&&t.sortAscending;if(!m&&!p){var v=null===(i=null==c?void 0:c.ViewMetadata)||void 0===i?void 0:i.ListViewXml;if(v)try{var y=(0,d.a)(v);if(y&&y.sortFields&&1===y.sortFields.length){var S=y.sortFields[0],D=S.sortField,I=S.sortAsc;D&&void 0!==I&&(b=D,g=!!I)}}catch(e){}}var x=t.filterParams;(h||u)&&"?"!==h&&(x=null==h?void 0:h.substring(1));var C=t.webAbsoluteUrl;return C||_||!(null===(r=null==e?void 0:e.pageContext)||void 0===r?void 0:r.webAbsoluteUrl)||(C=e.pageContext.webAbsoluteUrl),(0,a.W_)((0,a.W_)({},t),{webAbsoluteUrl:C,sortFieldKey:b,sortAscending:g,filterParams:x,groupByFieldKey:(null===(s=null==c?void 0:c.ListSchema)||void 0===s?void 0:s.group1)||t.groupByFieldKey})}(t,D,S),T=(0,a.W_)((0,a.W_)({key:e},P),{rootFolderItem:t.rootFolderItem||(null==S?void 0:S.rootFolderItem),items:(null==S?void 0:S.items.slice(0,(null==S?void 0:S.items.length)-1))||[],groupings:null===(g=null==S?void 0:S.groupings)||void 0===g?void 0:g.slice(0,(null==S?void 0:S.groupings.length)-1),nextPageToken:null==t?void 0:t.nextPage,areAllGroupsCollapsed:M,sortAscending:!f||p||void 0!==P.sortAscending?P.sortAscending:null==S?void 0:S.sortAscending,sortFieldKey:!f||p||void 0!==P.sortFieldKey?P.sortFieldKey:null==S?void 0:S.sortFieldKey,isResolved:!0});return k=(null==S?void 0:S.collapsedGroupKeysSet)?new Set(S.collapsedGroupKeysSet):new Set,O&&O.length>0?T.groupings=v(D,T.items.length,T.groupings,O,T.items,C,0,A,E,void 0,M,k):(s=T.items).push.apply(s,C),T.nextPageToken&&(T.items.push((0,i.b)(r.a.serialize({itemSetKey:D,token:T.nextPageToken}))),null===(y=T.groupings)||void 0===y||y.push(i.a)),T.collapsedGroupKeysSet=k,T}function v(e,t,n,r,o,d,l,u,f,p,m,_){var h=new Map;if(n)for(var g=0,y=n;g<y.length;g++){var S=y[g];h.set(S.key,S)}var D=n||[],I=d.length>0;if(r)for(var x=0;x<r.length;x++){var C=r[x],O=void 0;if(void 0!==(S=h.get(b(C.groupingId)))){var w=0===(P=v(e,t,S.children,C.children,o,d,l+1,u,f,C.groupingId,m,_)).length,E=0,A=C.startIndex||0,L=(x<r.length-1?r[x+1].startIndex:null==d?void 0:d.length)||0;w&&(E=I?S.itemCount+L:1),O=(0,a.W_)((0,a.W_)({},S),{itemCount:E,data:C,children:P,hasMoreData:u&&!!f&&C.count>=f,columnAggregate:C.columnTotals}),D===n&&(D=(0,a.AE)([],n,!0));for(var k=0;k<D.length;k++){var M=D[k];O.key===M.key&&(D[k]=O)}w&&(I?L>0&&o.push.apply(o,d.slice(A,A+L)):o.push((0,i.b)(s.a.serialize({groupId:C.groupingId,itemSetKey:e}))))}else{var P;w=0===(P=v(e,t,void 0,C.children,o,d,l+1,u,f,C.groupingId,m,_)).length,E=0,A=C.startIndex||0,w&&(E=I?Math.min(C.count,d.length-A):1);var T=b(C.groupingId);O={key:T,name:C.name||c.f,itemCount:E,displayCount:C.count,data:C,children:P,hasMoreData:u&&!!f&&C.count>=f,parentKey:p&&b(p),columnAggregate:C.columnTotals},(m||C.isCollapsed)&&(null==_||_.add(T)),w&&(I?E>0&&o.push.apply(o,d.slice(A,A+E)):o.push((0,i.b)(s.a.serialize({groupId:C.groupingId,itemSetKey:e})))),D===n&&(D=(0,a.AE)([],n,!0)),D.push(O)}}return D}}
}]),define("shared-split-bundle~4afa07ba",[],{});