"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[35],{2964:function(e,t,n){n.d(t,{a:function(){return a}});var a={Schema:4}}
,3650:function(e,t,n){var a=n("tslib_826"),i=n(122),r=n(2964);function o(e){return!!e.fileHandler}function s(e){return o(e)&&!!e.promoted}function c(e){return o(e)&&!!e.builtIn}function d(e){return o(e)&&!!e.hidden}var l=/^(?:data|blob|javascript):/i,u=/^(?:data|http|https):/i;function f(e){return!l.test(e)}var p={svg:!0,png1x:!0,png1_5x:!0,png2x:!0};function m(e){var t,n;if(e)for(var a in e)if(p.hasOwnProperty(a)){var i=(n=e[a])&&u.test(n)?n:void 0;i&&(t||(t={}),t[a]=i)}return t}function _(e){return{file:e.file,folder:e.folder,allowMultiSelect:e.allowMultiSelect}}var h=function(){function e(e,t){this._dataRequestor=t.dataRequestor,this._prefetchCache=t.prefetchCache,this._localFileHandlerProvider=t.localFileHandlerProvider}return e.prototype.getFileHandlerData=function(e){return(0,a.Zd)(this,void 0,void 0,function(){var t,n,l,u,p,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L=this;return(0,a.qr)(this,function(k){switch(k.label){case 0:if(n=(t=e||{}).language,l=void 0===n?i.b.language:n,u=t.accessToken,p=void 0===u?void 0:u,h=t.endpoint,b=void 0===h?"":h,g=t.includePromotedApp,v=void 0!==g&&g,y=t.driveId,S=void 0===y?void 0:y,D=t.allowCookies,I=void 0===D?void 0:D,x=b+"/drive",S&&(x="me"===S?"".concat(b,"/me/drive"):"".concat(b,"/drives/").concat(S)),C=function(e){return(0,a.Zd)(L,void 0,void 0,function(){var t,n,i,l,u,p,h,b,g,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R,N,B,j,V,z;return(0,a.qr)(this,function(G){switch(G.label){case 0:return t={custom:[],create:[],open:[],preview:[]},n={},this._localFileHandlerProvider?(l=[[]],[4,this._localFileHandlerProvider.getLocalFileHandlers()]):[3,2];case 1:return i=a.AE.apply(void 0,[a.AE.apply(void 0,l.concat([G.sent(),!0])),e.value,!0]),[3,3];case 2:i=e.value,G.label=3;case 3:for(u=0,p=i;u<p.length;u++)if(o(h=p[u])&&!d(h)&&(b=v?s(h):void 0,g=c(h),y=h.application,S=h.id,D=h.actions,I=h.fileHandler,D&&(x=I.fileTypeDisplayName,C=I.fileTypeIconUrl,O=I.version)))for(w={id:S,appId:y.id,actionMenuDisplayName:I.actionMenuDisplayName,displayName:y.displayName,appIcon:m(I.appIcon),version:O,fileTypeDisplayName:x,fileTypeIcon:m(I.fileTypeIcon||{png1x:C}),isPromoted:b,isBuiltIn:g},E=0,A=0,L=D;A<L.length;A++)if(k=L[A],(M=k.url)&&f(M)&&(P=k.displayName,T=k.shortDisplayName,U=k.icon,F=k.availableOn)){switch(H="newFile"===k.type?"create":k.type,R={type:H,url:M,displayName:P,icon:m(U),availableOn:_(F),handler:w,id:E},N=F.file,B=N&&N.extensions,H){case"custom":if(!P)continue;if(R.shortDisplayName=T,!N&&!F.folder)continue;break;case"create":if(!B||!B[0])continue;break;case"open":case"preview":if(!N)continue;if(B&&!b)for(j=0,V=B;j<V.length;j++)z=V[j],(n[z]||(n[z]={open:[],preview:[]}))[H].push(R);break;default:continue}t[H].push(R),E++}return[2,{actions:t,preferences:n,version:r.a.Schema}]}})})},O=x+"/apps?"+(v?"select=*,promoted,builtIn&":"")+"$expand=actions",w="GetDriveApps",E=function(){return(0,a.Zd)(L,void 0,void 0,function(){var e;return(0,a.qr)(this,function(t){switch(t.label){case 0:return[4,this._dataRequestor.send({path:O,apiName:w,headers:{"Accept-Language":l},accessToken:p,useAuthorizationHeaders:!!p,allowCookies:I})];case 1:return e=t.sent(),[4,C(e)];case 2:return[2,t.sent()]}})})},!this._prefetchCache)return[3,5];k.label=1;case 1:return k.trys.push([1,4,,5]),[4,this._prefetchCache.getData({url:O,body:"",qosName:w})];case 2:return A=k.sent(),[4,C(A)];case 3:return[2,k.sent()];case 4:return k.sent(),[3,5];case 5:return[4,E()];case 6:return[2,k.sent()]}})})},e}();t.a=h}
,4343:function(e,t){var n=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.getPreAuthUrls=function(e){var t=e.items,n=e.accessToken,a=void 0===n?void 0:n,i=e.driveUrl,r=void 0===i?"":i,o=e.appId,s={items:t};return this._dataRequestor.send({path:"".concat(r||"/drive","/getPreAuthorizedUrls").concat(o?"?appId="+o:""),apiName:"GetPreAuthorizedUrls",postData:JSON.stringify(s),requestType:"POST",accessToken:a,useAuthorizationHeaders:!!a}).then(function(e){return e.value})},e}();t.a=n}
,6277:function(e,t,n){n.d(t,{a:function(){return o},b:function(){return r},c:function(){return i}});var a=n(910);function i(e,t){void 0===t&&(t=!0);var n=e.endpoint,a=e.driveId,i=t?a||"me":a;return"me"===i?n.indexOf("api.onedrive.com/v1.0")>-1||n.indexOf("storage.live-int.com/v1.0")>-1?"".concat(n,"/drive"):n.indexOf("/v2.")>-1?"".concat(n,"/drives/me"):"".concat(n,"/me/drive"):"".concat(n,"/").concat(i?"drives/".concat(encodeURIComponent(i)):"drive")}function r(e,t){var n=e||"root";return"".concat(t,"/items/").concat(n?encodeURIComponent(n):"")}function o(e){var t=(0,a.a)(e),n=t.endpoint,i=t.driveId,r=t.itemId;if(n)return{endpoint:n,driveId:i,itemId:void 0===r?"root":r}}}
,3523:function(e,t,n){n.d(t,{a:function(){return S}});var a=n("odsp.util_118"),i=n("tslib_826"),r=n(6277),o=n(100),s=n(62),c=n(306),d=n(217),l=function(){function e(e,t){this._getOneDriveDataSource=t.getOneDriveDataSource,this._fileHandlerService=t.fileHandlerService,this._appPageContext=t.appPageContext,this._preAuthService=t.preAuthService,this._vroomDataRequestor=t.vroomDataRequestor;var n=t.dataRequestorType,r=void 0===n?function(e){function n(n){return e.call(this,n,{pageContext:t.appPageContext,tokenProvider:void 0})||this}return(0,i.XJ)(n,e),n}(d.b):n;this._dataRequestor=new r((0,i.W_)({qosName:"FileHandlerDataSource"},a.HW.isActivated("892484e8-2020-4fce-b619-d246a23a8f41","12/08/2023","If context is failed, Mark expected failure")?{}:{normalizeErrors:!0}))}return e.prototype.getFileHandlerData=function(){return(0,i.Zd)(this,void 0,void 0,function(){var e;return(0,i.qr)(this,function(t){switch(t.label){case 0:return[4,this._getGraphEndpoint()];case 1:return e=t.sent(),[4,this._fileHandlerService.getFileHandlerData({endpoint:e,includePromotedApp:!0})];case 2:return[2,t.sent()]}})})},e.prototype.cacheFileHandlerData=function(e){return(0,i.Zd)(this,void 0,void 0,function(){var t,n,a;return(0,i.qr)(this,function(i){if(t="".concat(new o.default(this._appPageContext.webAbsoluteUrl).authority,"/_api/v2.0"),n={data:e,lastModified:Date.now(),signature:{endpoint:t,includePromotedApp:!0}},"localStorage"in window)try{a=this._getFileHandlerCacheKey(t,""),localStorage.setItem(a,JSON.stringify(n))}catch(e){}return[2]})})},e.prototype.getFileHandlerCacheData=function(){var e,t="".concat(new o.default(this._appPageContext.webAbsoluteUrl).authority,"/_api/v2.0"),n=this._getFileHandlerCacheKey(t,"");try{return"localStorage"in window&&(e=JSON.parse(localStorage.getItem(n)||""))&&Date.now()-e.lastModified<864e5?e:void 0}catch(e){return}},e.prototype.getItemUrls=function(e){var t;return(0,i.Zd)(this,void 0,void 0,function(){var n,o,c,d,l,u,f,p=this;return(0,i.qr)(this,function(i){switch(i.label){case 0:return n=e.appId,o=e.items,c=e.getPreAuthUrl,d=e.driveUrl,l=e.accessToken,c?(u=e.currentPageContext&&new s.b({context:{webAbsoluteUrl:e.currentPageContext.webAbsoluteUrl,listUrl:e.currentPageContext.listUrl}}),f=o.map(function(e){var t=u&&u.getUrlParts({path:a.HW.isActivated("b46929a9-8604-43ed-9aa1-c6cdc5c1326e")?e.path:e.itemFullUrl||e.path});return(null==t?void 0:t.fullItemUrl)||""}),[4,null===(t=this._preAuthService)||void 0===t?void 0:t.getPreAuthUrls({appId:n,items:f,driveUrl:d,accessToken:l})]):[2,o.map(function(e){var t=a.HW.isActivated("c34c788c-b5e1-46b1-91e6-55fefa85050d","09/09/2023","Shoud call graph v1 endpoint instead of beta")?"".concat(p._appPageContext.msGraphEndpointUrl,"/beta"):"".concat(p._appPageContext.msGraphEndpointUrl,"/v1.0"),n=(0,r.c)({driveId:"",endpoint:t}),i=e.driveItemUrl?(0,r.a)(e.driveItemUrl):void 0;return i?(0,r.b)(i.itemId,n):""})];case 1:return[2,i.sent()]}})})},e.prototype.getDriveItem=function(e,t){var n;return(0,i.Zd)(this,void 0,void 0,function(){var r;return(0,i.qr)(this,function(i){if(r="".concat(e,"/shares/u!").concat(t,"/driveItem?$select=*"),!this._vroomDataRequestor)throw new a.EI({code:"VroomDataRequestorNotAvailable"});return[2,null===(n=this._vroomDataRequestor)||void 0===n?void 0:n.send({path:r,endpoint:e,requestType:"GET",apiName:"getDriveItem"})]})})},e.prototype.createCustomDocument=function(e){return(0,i.Zd)(this,void 0,void 0,function(){var t,n,r,o,c,d,l,u,f;return(0,i.qr)(this,function(i){switch(i.label){case 0:return t=e.parentFolderPath,n=e.webAbsoluteUrl,r=e.listFullUrl,o=e.extension,c=new s.b({context:{webAbsoluteUrl:n,listUrl:r}}),d=c.getUrlParts({path:t}),l=d.fullItemUrl,[4,this._dataRequestor.getData({url:this._getCreateCustomDocumentUrl({webAbsoluteUrl:n,listFullUrl:r,parentFolderPath:d.listRelativeItemUrl||"",extension:o}),method:"POST",qosName:"createCustomDocument",noRedirect:!0,webAbsoluteUrl:n})];case 1:if(u=i.sent(),!(f=u&&u.d&&u.d.CreateDocumentWithDefaultName))throw new a.EI({code:"MissingNameFromCreateDocument"});return[2,l+"/"+f]}})})},e.prototype._getFileHandlerCacheKey=function(e,t){return"".concat("fileHandlerCache_").concat(JSON.stringify({endpoint:e,driveId:t}))},e.prototype._getGraphEndpoint=function(){var e=this;return this._getOneDriveDataSource().then(function(t){return(0,i.Zd)(e,void 0,void 0,function(){var e,n;return(0,i.qr)(this,function(i){switch(i.label){case 0:return[4,t.getPersonalUrl()];case 1:return e=i.sent(),a.HW.isActivated("a540eb4a-5fb0-42ad-a4d5-c82aa83401b4")?[2,e]:(n=e&&new o.default(e).authority,[2,"".concat(n,"/_api/v2.0")])}})})})},e.prototype._getCreateCustomDocumentUrl=function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,i=e.extension,r=e.parentFolderPath;if(!i)throw new a.EI({code:"NoDocumentExtension"});return(0,c.b)({webAbsoluteUrl:t,listFullUrl:n}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:r,extension:i}).toString()},e}(),u=n(612),f=n(3650),p=n(1250),m=n(1177),_=n(1599),h=n(17),b=(0,a.c7)("LocalFileHandlerDataSource.key",_.a,{pageContext:h.a}),g=(0,a.c7)("FileHandlerService.key",f.a,{dataRequestor:m.a,localFileHandlerProvider:b,prefetchCache:p.a.optional}),v=n(4343),y=(0,a.c7)("preAuthService.key",v.a,{dataRequestor:m.a}),S=(0,a.c7)("FileHandlerDataSource.key",l,{getOneDriveDataSource:u.a.async.bypass,fileHandlerService:g,appPageContext:h.a,preAuthService:y,vroomDataRequestor:m.a})}
,8563:function(e,t,n){function a(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)}n.d(t,{a:function(){return a}})}
}]),define("shared-split-bundle~65284673",[],{});